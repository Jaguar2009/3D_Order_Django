{% extends 'base.html' %}
{% load static %}

{% block title %}Адмін - Матеріали{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/admin_materials.css' %}">
{% endblock %}

{% block body %}
<div class="container">
    <h1>Список матеріалів</h1>
    <a href="{% url 'create_material' %}" class="btn btn-success">Додати матеріал</a>
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Назва</th>
                <th>Ціна за метр</th>
                <th>Колір</th>
                <th>Дії</th>
            </tr>
        </thead>
        <tbody>
            {% for material in materials %}
            <tr>
                <td>{{ material.id }}</td>
                <td>{{ material.parameter_name }}</td>
                <td>{{ material.parameter_value }}</td>
                <td>{{ material.color|default:"-" }}</td>
                <td>
                    <a href="{% url 'edit_material' material.id %}" class="btn btn-warning">Редагувати</a>
                    <button class="delete-button" onclick="openDeleteModal({{ material.id }})">Видалити</button>
                </td>
            </tr>

                <!-- Модальне вікно для підтвердження видалення -->
                <div id="deleteModal" class="modal">
                    <div class="modal-content">
                        <h3>Ви впевнені, що хочете видалити матеріал?</h3>
                        <!-- Form with the action already set directly in the template -->
                        <form id="delete-form" method="POST" action="{% url 'delete_material' material.id %}">
                            {% csrf_token %}
                            <button type="submit" class="confirm-button">Підтвердити</button>
                        </form>
                        <button id="cancelDelete" class="cancel-button">Скасувати</button>
                    </div>
                </div>
            {% empty %}
            <tr>
                <td colspan="5">Матеріали не знайдено.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>


<script>
    document.addEventListener("DOMContentLoaded", function () {
    const modal = document.getElementById("deleteModal");
    const cancelDeleteButton = document.getElementById("cancelDelete");

    window.openDeleteModal = function (materialId) {
        // Show the modal
        modal.style.display = "block";
    };

    if (cancelDeleteButton) {
        cancelDeleteButton.addEventListener("click", function () {
            modal.style.display = "none"; // Close the modal
        });
    }

    window.addEventListener("click", function (event) {
        if (event.target === modal) {
            modal.style.display = "none"; // Close when clicking outside modal
        }
    });
});
</script>
</div>
{% endblock %}
